<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rialo Space </title>
    <!-- Memuat Tailwind CSS untuk styling modern -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Menggunakan font Inter yang bersih */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            text-align: center;
            background-color: #0d1117; /* Warna gelap */
            color: #ffffff;
            /* Hapus padding vertikal agar game bisa mengisi layar lebih penuh */
            padding: 20px 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Container utama game, sekarang responsif mengisi layar */
        #main {
            /* Menggunakan Tailwind untuk lebar dan tinggi responsif */
            /* Lebar: 90% dari viewport lebar, Maks 700px */
            max-width: 700px;
            width: 90vw; 
            /* Tinggi: 85% dari viewport tinggi */
            height: 85vh; 
            
            /* Background dan properti lainnya */
            background: url('background.jpg') repeat-y;
            background-size: cover;
            margin: 10px auto; /* Margin atas/bawah dikurangi */
            position: relative; 
            overflow: hidden;
            border: 4px solid #4a5568;
            border-radius: 12px;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
            /* Catatan: Rasio aspek akan dihitung dan disetel di JavaScript
               untuk memastikan pesawat dan meteor tidak terdistorsi. */
        }

        #area {
            width: 100%;
            height: 100%;
            position: absolute;
            z-index: 100;
        }
        
        /* Animasi Pesawat (Plane) */
        @keyframes planetJet {
            0%, 100% { background-image: url('plane1.png'); }
            50% { background-image: url('plane2.png'); }
        }
        
        #plane {
            /* Ukuran sekarang ditetapkan dalam Piksel oleh JS */
            background-image: url('plane1.png');
            background-size: 100%;
            background-repeat: no-repeat;
            position: absolute;
            animation: planetJet 0.3s infinite;
            transform: translateZ(0);
        }
        
        /* Animasi Meteor */
        @keyframes meteorFire {
            0%, 100% { background-image: url('meteor1.png'); }
            50% { background-image: url('meteor2.png'); }
        }

        #meteor {
            /* Ukuran sekarang ditetapkan dalam Piksel oleh JS */
            background-image: url('meteor1.png');
            background-size: 100%;
            background-repeat: no-repeat;
            animation: meteorFire 0.3s infinite;
            position: absolute;
            transform: translateZ(0);
        }

        /* Styling Game Over Modal */
        .modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>

    <!-- Container luar kini menggunakan flex untuk centering yang lebih baik -->
    <div class="w-full flex flex-col items-center justify-start">
        <div class="max-w-xl w-full"> 
            <h1 class="text-4xl font-extrabold text-indigo-400 mb-2 mt-4 drop-shadow-lg">Rialo Space</h1>
            <h3 class="text-xl font-medium text-gray-300 mb-4">Score: <span id="Score" class="font-bold text-yellow-400">0</span></h3>
        </div>
        
        <!-- Area Game Utama -->
        <div id="main">
            <div id="area">
                <div id="plane"></div>
                <div id="meteor"></div>

                <!-- Game Over Modal -->
                <div id="gameOverMessage" class="modal hidden">
                    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl text-white max-w-xs w-full border-2 border-red-500">
                        <p class="text-3xl font-bold mb-4 text-red-400">GAME OVER!</p>
                        <p class="text-lg mb-6">Your Score:</p>
                        <p id="finalScore" class="text-5xl font-extrabold text-yellow-300 mb-8">0</p>
                        <button onclick="startGame()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 w-full">
                            Ready? (Press SpaceBar)
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <p class="text-sm text-gray-500 mt-4 max-w-xl">Use the arrow keys to move the Plane</p>

    </div>

<script>
    // Variabel status game
    let isMoving = false; 
    let planeElement;
    let meteorElement;
    let backgroundElement;
    let scoreElement;
    let gameOverMessageElement;
    
    // Konstanta Game akan dihitung secara dinamis
    let GAME_AREA_WIDTH = 400; // Lebar standar (basis perhitungan)
    let GAME_AREA_HEIGHT = 500; // Tinggi standar (basis perhitungan)

    // Konstanta Ukuran Objek dan Kecepatan (menggunakan basis piksel dari desain 400x500)
    const BASE_PLANE_WIDTH = 100;
    const BASE_PLANE_HEIGHT = 130;
    const BASE_METEOR_WIDTH = 96;
    const BASE_METEOR_HEIGHT = 100;

    let MOVEMENT_STEP = 1; // Kecepatan langkah pesawat ditingkatkan
    let METEOR_SPEED = 5; // Kecepatan meteor
    const BACKGROUND_SPEED = 1; // Kecepatan scrolling background
    
    // Variabel Posisi (Selalu disimpan dalam PIKSEL, agar perhitungan tabrakan akurat)
    let planeX = 150; 
    let planeY = 400; 
    let meteorX = 200;
    let meteorY = -100;
    let backgroundY = 0;
    let score = 0;
    
    // Objek untuk menyimpan status tombol yang ditekan
    const keysPressed = {};

    // --- Fungsi utilitas untuk membersihkan nilai CSS menjadi integer ---
    function getBackgroundPositionY(element) {
        const style = element.style.backgroundPositionY || '0px';
        return parseInt(style.replace('px', ''), 10);
    }

    // --- FUNGSI UTAMA GAME LOOP (Menggunakan requestAnimationFrame) ---
    function gameLoop(timestamp) {
        if (!isMoving) return;

        // 1. Pergerakan Latar Belakang & Skor
        backgroundY += BACKGROUND_SPEED;
        if (backgroundY > GAME_AREA_HEIGHT) {
            backgroundY = 0;
        }
        backgroundElement.style.backgroundPositionY = backgroundY + 'px';

        // Update Score (Berjalan setiap frame, lebih akurat)
        score++;
        scoreElement.innerHTML = Math.floor(score / 60); 

        // 2. Pergerakan Pesawat (berdasarkan tombol yang ditekan)
        
        // Horizontal Movement
        if (keysPressed[37]) { // Left
            planeX = Math.max(0, planeX - MOVEMENT_STEP);
        }
        if (keysPressed[39]) { // Right
            planeX = Math.min(GAME_AREA_WIDTH - planeElement.clientWidth, planeX + MOVEMENT_STEP);
        }

        // Vertical Movement
        if (keysPressed[38]) { // Up
            planeY = Math.max(0, planeY - MOVEMENT_STEP);
        }
        if (keysPressed[40]) { // Down
            planeY = Math.min(GAME_AREA_HEIGHT - planeElement.clientHeight, planeY + MOVEMENT_STEP);
        }

        planeElement.style.left = planeX + 'px'; 
        planeElement.style.top = planeY + 'px';   


        // 3. Pergerakan Meteor
        meteorY += METEOR_SPEED;
        
        // Reset Meteor jika sudah melewati area bawah
        if (meteorY > GAME_AREA_HEIGHT) {
            meteorX = Math.floor(Math.random() * (GAME_AREA_WIDTH - meteorElement.clientWidth));
            meteorY = -meteorElement.clientHeight;
        }
        
        meteorElement.style.left = meteorX + 'px';
        meteorElement.style.top = meteorY + 'px';


        // 4. Pengecekan Tabrakan (Collision Detection)
        
        // Tentukan "Hitbox" lebih kecil dari ukuran gambar
        // Ditingkatkan untuk membatasi jangkauan tabrakan (membuatnya lebih akurat)
        const planePadding = planeElement.clientWidth * 0.30; // 30% padding horizontal (sebelumnya 20%)
        const meteorPadding = meteorElement.clientWidth * 0.25; // 25% padding horizontal (sebelumnya 15%)

        // Batas-batas objek Pesawat (lebih kecil)
        const planeLeft = planeX + planePadding;
        const planeRight = planeX + planeElement.clientWidth - planePadding;
        const planeTop = planeY + planePadding * 0.5; // Padding vertikal (sekitar 15%)
        const planeBottom = planeY + planeElement.clientHeight - planePadding * 0.5;

        // Batas-batas objek Meteor (lebih kecil)
        const meteorLeft = meteorX + meteorPadding;
        const meteorRight = meteorX + meteorElement.clientWidth - meteorPadding;
        const meteorTop = meteorY + meteorPadding * 0.5; // Padding vertikal (sekitar 12.5%)
        const meteorBottom = meteorY + meteorElement.clientHeight - meteorPadding * 0.5;


        const collision = (
            planeLeft < meteorRight &&
            planeRight > meteorLeft &&
            planeTop < meteorBottom &&
            planeBottom > meteorTop
        );

        if (collision) {
            endGame();
        } else {
            // Panggil frame berikutnya
            requestAnimationFrame(gameLoop);
        }
    }

    // Menghentikan game
    function endGame() {
        if (!isMoving) return; 

        isMoving = false;
        
        document.getElementById('finalScore').innerHTML = Math.floor(score / 60);
        gameOverMessageElement.classList.remove('hidden');
    }

    // Fungsi untuk memulai atau mengulang game
    function startGame() {
        if (isMoving) return;
        
        // Inisialisasi ulang area game dan dimensinya
        updateGameAreaDimensions();

        // Reset variabel game
        score = 0;
        backgroundY = 0;
        
        // Posisi awal disesuaikan dengan dimensi baru
        planeX = (GAME_AREA_WIDTH - planeElement.clientWidth) / 2; // Tengah horizontal
        planeY = GAME_AREA_HEIGHT - planeElement.clientHeight - 20; // 20px dari bawah
        meteorX = Math.floor(Math.random() * (GAME_AREA_WIDTH - meteorElement.clientWidth));
        meteorY = -meteorElement.clientHeight; 
        
        scoreElement.innerHTML = '0';
        planeElement.style.left = planeX + 'px';
        planeElement.style.top = planeY + 'px';
        meteorElement.style.left = meteorX + 'px';
        meteorElement.style.top = meteorY + 'px';
        backgroundElement.style.backgroundPositionY = '0px';

        gameOverMessageElement.classList.add('hidden');
        
        // Mulai Game Loop
        isMoving = true;
        requestAnimationFrame(gameLoop);
    }


    // Inisialisasi Event Listener untuk pergerakan pesawat
    function setupMovementListener() {
        // Ketika tombol ditekan
        window.addEventListener('keydown', function(e) {
            // Cek apakah tombol yang ditekan adalah tombol panah (37-40)
            if (e.keyCode >= 37 && e.keyCode <= 40) {
                e.preventDefault(); // Mencegah browser scroll
                if (isMoving) {
                    keysPressed[e.keyCode] = true;
                }
            } else if (e.keyCode === 32) { // Tombol Spasi
                e.preventDefault(); 
                startGame();
            }
        });

        // Ketika tombol dilepas
        window.addEventListener('keyup', function(e) {
            if (e.keyCode >= 37 && e.keyCode <= 40) {
                keysPressed[e.keyCode] = false;
            }
        });
    }

    // --- FUNGSI UNTUK MENDAPATKAN DIMENSI AREA GAME SECARA DINAMIS DAN MENSKALAKAN OBJEK ---
    function updateGameAreaDimensions() {
        // Ambil lebar dan tinggi aktual dari elemen #main (dalam piksel)
        let newWidth = backgroundElement.clientWidth;
        let newHeight = backgroundElement.clientHeight;

        // Tentukan faktor skala berdasarkan lebar baru 
        const scaleFactor = newWidth / 400; // Skala relatif terhadap desain 400px

        // Terapkan Rasio Aspek (4:5)
        const expectedHeight = newWidth * (5/4); 

        // Jika tinggi viewport (newHeight) lebih kecil dari tinggi yang diharapkan, 
        // kita perlu membatasi lebar agar tidak melebihi viewport.
        if (newHeight < expectedHeight) {
            // Batasi lebar berdasarkan tinggi agar rasio tetap 4:5
            newWidth = newHeight * (4/5);
            // Setel ulang lebar #main di DOM agar sesuai
            backgroundElement.style.width = newWidth + 'px';
        }
        
        // Perbarui dimensi game area dengan nilai final
        GAME_AREA_WIDTH = newWidth;
        GAME_AREA_HEIGHT = backgroundElement.clientHeight; // Ambil tinggi aktual setelah penyesuaian lebar (jika ada)

        // Hitung ulang faktor skala akhir
        const finalScaleFactor = GAME_AREA_WIDTH / 400;

        // MOVEMENT_STEP dan METEOR_SPEED disesuaikan
        MOVEMENT_STEP = 15 * finalScaleFactor;
        METEOR_SPEED = 3 * finalScaleFactor;

        // Ukuran Pesawat dan Meteor disesuaikan dengan skala baru (ditetapkan dalam Piksel)
        planeElement.style.width = (BASE_PLANE_WIDTH * finalScaleFactor) + 'px';
        planeElement.style.height = (BASE_PLANE_HEIGHT * finalScaleFactor) + 'px';
        meteorElement.style.width = (BASE_METEOR_WIDTH * finalScaleFactor) + 'px';
        meteorElement.style.height = (BASE_METEOR_HEIGHT * finalScaleFactor) + 'px';
    }

    // --- FUNGSI INISIALISASI (saat halaman dimuat) ---
    window.onload = function() {
        // Ambil referensi elemen
        planeElement = document.getElementById('plane');
        meteorElement = document.getElementById('meteor');
        backgroundElement = document.getElementById('main');
        scoreElement = document.getElementById('Score');
        gameOverMessageElement = document.getElementById('gameOverMessage');

        if (!planeElement || !meteorElement || !backgroundElement || !scoreElement || !gameOverMessageElement) {
            console.error("Kesalahan: Salah satu elemen game tidak ditemukan.");
            backgroundElement.innerHTML = "<p class='p-4 text-center text-red-500'>Gagal memuat game. Periksa konsol untuk detail error.</p>";
            return;
        }

        // Setel posisi dan ukuran dinamis saat pertama kali dimuat
        updateGameAreaDimensions();
        
        // Setup listener
        setupMovementListener();
        
        // Tambahkan listener untuk menangani perubahan ukuran layar (agar responsif)
        window.addEventListener('resize', () => {
             updateGameAreaDimensions();
             // Memposisikan ulang pesawat dan meteor
             planeElement.style.left = planeX + 'px'; 
             planeElement.style.top = planeY + 'px';   
             meteorElement.style.left = meteorX + 'px';
             meteorElement.style.top = meteorY + 'px';
        });

        // Set posisi awal dan tampilkan Game Over Modal
        startGame(); 
        isMoving = false;
        gameOverMessageElement.classList.remove('hidden');
        document.getElementById('finalScore').innerHTML = '0';
    };

</script>
</body>
</html>



